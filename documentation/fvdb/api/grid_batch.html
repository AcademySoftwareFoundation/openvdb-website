

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GridBatch &mdash; fVDB  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="JaggedTensor" href="jagged_tensor.html" />
    <link rel="prev" title="Volume Rendering" href="../tutorials/volume_rendering.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fVDB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to fVDB!</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_concepts.html">Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/building_grids.html">Building Sparse Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_grid_ops.html">Basic GridBatch Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/simple_unet.html">A Simple Convolutional U-Net</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/io.html">Sparse Grid I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/mutable_grids.html">Mutable Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/volume_rendering.html">Volume Rendering</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">GridBatch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fvdb.GridBatch"><code class="docutils literal notranslate"><span class="pre">GridBatch</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.address"><code class="docutils literal notranslate"><span class="pre">GridBatch.address</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.avg_pool"><code class="docutils literal notranslate"><span class="pre">GridBatch.avg_pool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.bbox"><code class="docutils literal notranslate"><span class="pre">GridBatch.bbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.bbox_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.bbox_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.clip"><code class="docutils literal notranslate"><span class="pre">GridBatch.clip()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.clipped_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.clipped_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.coarsened_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.coarsened_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.contiguous"><code class="docutils literal notranslate"><span class="pre">GridBatch.contiguous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.conv_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.conv_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.coords_in_active_voxel"><code class="docutils literal notranslate"><span class="pre">GridBatch.coords_in_active_voxel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cpu"><code class="docutils literal notranslate"><span class="pre">GridBatch.cpu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cubes_in_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.cubes_in_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cubes_intersect_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.cubes_intersect_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cuda"><code class="docutils literal notranslate"><span class="pre">GridBatch.cuda()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cum_enabled_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.cum_enabled_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cum_enabled_voxels_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.cum_enabled_voxels_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cum_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.cum_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.cum_voxels_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.cum_voxels_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.device"><code class="docutils literal notranslate"><span class="pre">GridBatch.device</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.disable_ijk"><code class="docutils literal notranslate"><span class="pre">GridBatch.disable_ijk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.disabled_mask"><code class="docutils literal notranslate"><span class="pre">GridBatch.disabled_mask</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.dual_bbox"><code class="docutils literal notranslate"><span class="pre">GridBatch.dual_bbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.dual_bbox_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.dual_bbox_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.dual_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.dual_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.enable_ijk"><code class="docutils literal notranslate"><span class="pre">GridBatch.enable_ijk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.enabled_mask"><code class="docutils literal notranslate"><span class="pre">GridBatch.enabled_mask</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.fill_from_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.fill_from_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.grid_count"><code class="docutils literal notranslate"><span class="pre">GridBatch.grid_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.grid_to_world"><code class="docutils literal notranslate"><span class="pre">GridBatch.grid_to_world()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.grid_to_world_matrices"><code class="docutils literal notranslate"><span class="pre">GridBatch.grid_to_world_matrices</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.ijk"><code class="docutils literal notranslate"><span class="pre">GridBatch.ijk</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.ijk_enabled"><code class="docutils literal notranslate"><span class="pre">GridBatch.ijk_enabled</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.ijk_to_index"><code class="docutils literal notranslate"><span class="pre">GridBatch.ijk_to_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.ijk_to_inv_index"><code class="docutils literal notranslate"><span class="pre">GridBatch.ijk_to_inv_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.is_contiguous"><code class="docutils literal notranslate"><span class="pre">GridBatch.is_contiguous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.is_same"><code class="docutils literal notranslate"><span class="pre">GridBatch.is_same()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.jagged_like"><code class="docutils literal notranslate"><span class="pre">GridBatch.jagged_like()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.jidx"><code class="docutils literal notranslate"><span class="pre">GridBatch.jidx</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.joffsets"><code class="docutils literal notranslate"><span class="pre">GridBatch.joffsets</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.marching_cubes"><code class="docutils literal notranslate"><span class="pre">GridBatch.marching_cubes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.max_grids_per_batch"><code class="docutils literal notranslate"><span class="pre">GridBatch.max_grids_per_batch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.max_pool"><code class="docutils literal notranslate"><span class="pre">GridBatch.max_pool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.mutable"><code class="docutils literal notranslate"><span class="pre">GridBatch.mutable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.neighbor_indexes"><code class="docutils literal notranslate"><span class="pre">GridBatch.neighbor_indexes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_bytes"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_bytes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_enabled_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_enabled_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_enabled_voxels_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_enabled_voxels_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_leaf_nodes"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_leaf_nodes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.num_voxels_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.num_voxels_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.origin_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.origin_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.origins"><code class="docutils literal notranslate"><span class="pre">GridBatch.origins</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.points_in_active_voxel"><code class="docutils literal notranslate"><span class="pre">GridBatch.points_in_active_voxel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.ray_implicit_intersection"><code class="docutils literal notranslate"><span class="pre">GridBatch.ray_implicit_intersection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.read_from_dense"><code class="docutils literal notranslate"><span class="pre">GridBatch.read_from_dense()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sample_bezier"><code class="docutils literal notranslate"><span class="pre">GridBatch.sample_bezier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sample_bezier_with_grad"><code class="docutils literal notranslate"><span class="pre">GridBatch.sample_bezier_with_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sample_trilinear"><code class="docutils literal notranslate"><span class="pre">GridBatch.sample_trilinear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sample_trilinear_with_grad"><code class="docutils literal notranslate"><span class="pre">GridBatch.sample_trilinear_with_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.segments_along_rays"><code class="docutils literal notranslate"><span class="pre">GridBatch.segments_along_rays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_from_dense_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_from_dense_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_from_ijk"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_from_ijk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_from_mesh"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_from_mesh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_from_nearest_voxels_to_points"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_from_nearest_voxels_to_points()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_from_points"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_from_points()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_global_origin"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_global_origin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.set_global_voxel_size"><code class="docutils literal notranslate"><span class="pre">GridBatch.set_global_voxel_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sparse_conv_halo"><code class="docutils literal notranslate"><span class="pre">GridBatch.sparse_conv_halo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.sparse_conv_kernel_map"><code class="docutils literal notranslate"><span class="pre">GridBatch.sparse_conv_kernel_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.splat_bezier"><code class="docutils literal notranslate"><span class="pre">GridBatch.splat_bezier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.splat_trilinear"><code class="docutils literal notranslate"><span class="pre">GridBatch.splat_trilinear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.subdivide"><code class="docutils literal notranslate"><span class="pre">GridBatch.subdivide()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.subdivided_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.subdivided_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.to"><code class="docutils literal notranslate"><span class="pre">GridBatch.to()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.total_bbox"><code class="docutils literal notranslate"><span class="pre">GridBatch.total_bbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.total_bytes"><code class="docutils literal notranslate"><span class="pre">GridBatch.total_bytes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.total_enabled_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.total_enabled_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.total_leaf_nodes"><code class="docutils literal notranslate"><span class="pre">GridBatch.total_leaf_nodes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.total_voxels"><code class="docutils literal notranslate"><span class="pre">GridBatch.total_voxels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.uniform_ray_samples"><code class="docutils literal notranslate"><span class="pre">GridBatch.uniform_ray_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.viz_edge_network"><code class="docutils literal notranslate"><span class="pre">GridBatch.viz_edge_network</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.voxel_size_at"><code class="docutils literal notranslate"><span class="pre">GridBatch.voxel_size_at()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.voxel_sizes"><code class="docutils literal notranslate"><span class="pre">GridBatch.voxel_sizes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.voxels_along_rays"><code class="docutils literal notranslate"><span class="pre">GridBatch.voxels_along_rays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.world_to_grid"><code class="docutils literal notranslate"><span class="pre">GridBatch.world_to_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.world_to_grid_matrices"><code class="docutils literal notranslate"><span class="pre">GridBatch.world_to_grid_matrices</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fvdb.GridBatch.write_to_dense"><code class="docutils literal notranslate"><span class="pre">GridBatch.write_to_dense()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jagged_tensor.html">JaggedTensor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nn.html">fvdb.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">fvdb.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fVDB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GridBatch</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/grid_batch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gridbatch">
<h1>GridBatch<a class="headerlink" href="#gridbatch" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="fvdb.GridBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fvdb.</span></span><span class="sig-name descname"><span class="pre">GridBatch</span></span><a class="headerlink" href="#fvdb.GridBatch" title="Link to this definition"></a></dt>
<dd><p>A batch of sparse VDB grids.</p>
<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.address">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">address</span></span><a class="headerlink" href="#fvdb.GridBatch.address" title="Link to this definition"></a></dt>
<dd><p>The memory address of the underlying C++ GridBatch object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.avg_pool">
<span class="sig-name descname"><span class="pre">avg_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.avg_pool" title="Link to this definition"></a></dt>
<dd><p>Downsample this batch of grids using average pooling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool_factor</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – How much to pool by (i,e, <cite>(2,2,2)</cite> means take average over 2x2x2 from start of window).</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – Data at each voxel in this grid to be downsampled (JaggedTensor of shape <cite>[B, -1, *]</cite>).</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – The stride to use when pooling</p></li>
<li><p><strong>coarse_grid</strong> (<a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><em>GridBatch</em></a><em>, </em><em>optional</em>) – An optional coarse grid used to specify the output. This is mainly used
for memory efficiency so you can chache grids. If you don’t pass it in, we’ll just create it for you.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>coarse_data</strong> (<em>JaggedTensor</em>) – a JaggedTensor of shape <cite>[B, -1, *]</cite> of downsampled data.</p></li>
<li><p><strong>coarse_grid</strong> (<em>GridBatch</em>) – the downsampled grid batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.bbox">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bbox</span></span><a class="headerlink" href="#fvdb.GridBatch.bbox" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 2, 3] tensor of the bounding box of each grid in this batch where <cite>bbox[i, 0]</cite> is the minimimum ijk coordinate of the i^th grid, and <cite>bbox[i, 1]</cite> is the maximum ijk coordinate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.bbox_at">
<span class="sig-name descname"><span class="pre">bbox_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#fvdb.GridBatch.bbox_at" title="Link to this definition"></a></dt>
<dd><p>Get the bounding box (in voxel coordinates) of the bi^th grid in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bi</strong> (<em>int</em>) – The index of the grid to get the bounding box of.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bbox</strong> (<em>torch.Tensor</em>) – A tensor, bbox, of shape [2, 3] where bbox = [[bmin_i, bmin_j, bmin_z=k],
[bmax_i, bmax_j, bmax_k]] is the bi^th bounding box such that bmin &lt;= ijk &lt; bmax for all voxels
ijk in the bi^th grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.clip">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.clip" title="Link to this definition"></a></dt>
<dd><p>Return a batch of grids representing the clipped version of this batch of grids and corresponding features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> containing features associated with this batch of grids.</p></li>
<li><p><strong>ijk_min</strong> (<em>list</em><em> of </em><em>int triplets</em>) – Index space minimum bound of the clip region.</p></li>
<li><p><strong>ijk_max</strong> (<em>list</em><em> of </em><em>int triplets</em>) – Index space maximum bound of the clip region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>clipped_features</strong> (<em>JaggedTensor</em>) – a JaggedTensor of shape <cite>[B, -1, *]</cite> of clipped data.</p></li>
<li><p><strong>clipped_grid</strong> (<em>GridBatch</em>) – the clipped grid batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.clipped_grid">
<span class="sig-name descname"><span class="pre">clipped_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.clipped_grid" title="Link to this definition"></a></dt>
<dd><p>Return a batch of grids representing the clipped version of this batch.
Each voxel <cite>[i, j, k]</cite> in the input batch is included in the output if it lies within <cite>ijk_min</cite> and <cite>ijk_max</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ijk_min</strong> (<em>list</em><em> of </em><em>int triplets</em>) – Index space minimum bound of the clip region.</p></li>
<li><p><strong>ijk_max</strong> (<em>list</em><em> of </em><em>int triplets</em>) – Index space maximum bound of the clip region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>clipped_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the clipped version of this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.coarsened_grid">
<span class="sig-name descname"><span class="pre">coarsened_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarsening_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.coarsened_grid" title="Link to this definition"></a></dt>
<dd><p>Return a batch of grids representing the coarsened version of this batch.
Each voxel <cite>[i, j, k]</cite> in this grid batch maps to voxel <cite>[i / branchFactor, j / branchFactor, k / branchFactor]</cite> in the coarse batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coarsening_factor</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – How much to coarsen by (i,e, <cite>(2,2,2)</cite> means take every other voxel from start of window).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coarsened_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the coarsened version of this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.contiguous">
<span class="sig-name descname"><span class="pre">contiguous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.contiguous" title="Link to this definition"></a></dt>
<dd><p>Return a contiguous copy of this grid batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.conv_grid">
<span class="sig-name descname"><span class="pre">conv_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.conv_grid" title="Link to this definition"></a></dt>
<dd><p>Return a batch of grids representing the convolution of this batch with a given kernel.
Each voxel <cite>[i, j, k]</cite> in the output batch is the sum of the voxels in the input batch <cite>[i * stride, j * stride, k * stride]</cite> to <cite>[i * stride + kernel_size, j * stride + kernel_size, k * stride + kernel_size]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – The size of the kernel to convolve with.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – The stride to use when convolving.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>conv_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the convolution of this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.coords_in_active_voxel">
<span class="sig-name descname"><span class="pre">coords_in_active_voxel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_disabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.coords_in_active_voxel" title="Link to this definition"></a></dt>
<dd><p>Given a set of ijk coordinates, return a JaggedTensor of booleans indicating which coordinates are active in this gridbatch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ijk</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of integer ijk coordinates.</p></li>
<li><p><strong>ignore_disabled</strong> (<em>bool</em>) – Whether to ignore disabled voxels when computing the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coords_in_active_voxel</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1]</cite> of booleans indicating which coordinates are in the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.cpu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cubes_in_grid">
<span class="sig-name descname"><span class="pre">cubes_in_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_disabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.cubes_in_grid" title="Link to this definition"></a></dt>
<dd><p>Given a set of cube centers and extents, return a JaggedTensor of booleans indicating whether cubes fully reside in active voxels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube_centers</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of cube centers.</p></li>
<li><p><strong>cube_min</strong> (<em>float</em><em> or </em><em>triple</em><em> of </em><em>floats</em>) – The minimum extent of each cube (all cubes have the same size).</p></li>
<li><p><strong>cube_max</strong> (<em>float</em><em> or </em><em>triple</em><em> of </em><em>floats</em>) – The maximum extent of the cube (all cubes have the same size).</p></li>
<li><p><strong>ignore_disabled</strong> (<em>bool</em>) – Whether to ignore disabled voxels when computing the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cubes_intersect_grid</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1]</cite> of booleans indicating whether cubes fully reside in active voxels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cubes_intersect_grid">
<span class="sig-name descname"><span class="pre">cubes_intersect_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_disabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.cubes_intersect_grid" title="Link to this definition"></a></dt>
<dd><p>Given a set of cube centers and extents, return a JaggedTensor of booleans indicating whether cubes intersect active voxels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube_centers</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of cube centers.</p></li>
<li><p><strong>cube_min</strong> (<em>float</em><em> or </em><em>triple</em><em> of </em><em>floats</em>) – The minimum extent of each cube (all cubes have the same size).</p></li>
<li><p><strong>cube_max</strong> (<em>float</em><em> or </em><em>triple</em><em> of </em><em>floats</em>) – The maximum extent of the cube (all cubes have the same size).</p></li>
<li><p><strong>ignore_disabled</strong> (<em>bool</em>) – Whether to ignore disabled voxels when computing the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cubes_intersect_grid</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1]</cite> of booleans indicating whether cubes intersect active voxels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.cuda" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.cum_enabled_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cum_enabled_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.cum_enabled_voxels" title="Link to this definition"></a></dt>
<dd><p>An integer tensor containing the cumulative number of voxels enabled in each grid in this batch. i.e. <cite>[nvox_0, nvox_0+nvox_1, nvox_0+nvox_1+nvox_2, …]</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cum_enabled_voxels_at">
<span class="sig-name descname"><span class="pre">cum_enabled_voxels_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#fvdb.GridBatch.cum_enabled_voxels_at" title="Link to this definition"></a></dt>
<dd><p>Get the cumulative number of enabled voxels in the bi^th grid in the batch. i.e. <cite>nvox_0+nvox_1+…+nvox_i</cite>. If this grid isn’t mutable, this returns the same value as cum_voxels_at.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.cum_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cum_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.cum_voxels" title="Link to this definition"></a></dt>
<dd><p>An integer tensor containing the cumulative number of voxels indexed by the grids in this batch.
i.e. <cite>[nvox_0, nvox_0+nvox_1, nvox_0+nvox_1+nvox_2, …]</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.cum_voxels_at">
<span class="sig-name descname"><span class="pre">cum_voxels_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#fvdb.GridBatch.cum_voxels_at" title="Link to this definition"></a></dt>
<dd><p>Get the cumulative number of voxels in the bi^th grid in the batch. i.e. <cite>nvox_0+nvox_1+…+nvox_i</cite></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#fvdb.GridBatch.device" title="Link to this definition"></a></dt>
<dd><p>The device on which this grid is stored.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.disable_ijk">
<span class="sig-name descname"><span class="pre">disable_ijk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.disable_ijk" title="Link to this definition"></a></dt>
<dd><p>If this is grid is mutable, disable voxels at the specified coordinates, otherwise throw an exception.
If the ijk values are already disabled or are not represented in this GridBatch, then this function is no-op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ijk</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of ijk coordinates to disable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.disabled_mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">disabled_mask</span></span><a class="headerlink" href="#fvdb.GridBatch.disabled_mask" title="Link to this definition"></a></dt>
<dd><p>A boolean JaggedTensor of shape [B, -1] indicating whether each voxel in the grid is disabled or not.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.dual_bbox">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_bbox</span></span><a class="headerlink" href="#fvdb.GridBatch.dual_bbox" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 2, 3] tensor of the bounding box of the dual of each grid in this batch where bbox[i, 0] is the minimimum ijk coordinate of the i^th dual grid, and bbox[i, 1] is the maximum ijk coordinate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.dual_bbox_at">
<span class="sig-name descname"><span class="pre">dual_bbox_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#fvdb.GridBatch.dual_bbox_at" title="Link to this definition"></a></dt>
<dd><p>Get the bounding box (in voxel coordinates) of the dual of the bi^th grid in the batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.dual_grid">
<span class="sig-name descname"><span class="pre">dual_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_border</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.dual_grid" title="Link to this definition"></a></dt>
<dd><p>Return a batch of grids representing the dual of this batch.
i.e. The centers of the dual grid correspond to the corners of this grid batch. The <cite>[i, j, k]</cite> coordinate of the dual grid corresponds to the bottom/left/back
corner of the <cite>[i, j, k]</cite> voxel in this grid batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>exclude_border</strong> (<em>bool</em>) – Whether to exclude the border of the grid batch when computing the dual grid</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dual_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the dual of this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.enable_ijk">
<span class="sig-name descname"><span class="pre">enable_ijk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.enable_ijk" title="Link to this definition"></a></dt>
<dd><p>If this is grid is mutable, enable voxels at the specified coordinates, otherwise throw an exception.
If the ijk values are already enabled or are not represented in this GridBatch, then this function is no-op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ijk</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of ijk coordinates to disable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.enabled_mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enabled_mask</span></span><a class="headerlink" href="#fvdb.GridBatch.enabled_mask" title="Link to this definition"></a></dt>
<dd><p>A boolean JaggedTensor of shape [B, -1] indicating whether each voxel in the grid is enabled or not.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.fill_from_grid">
<span class="sig-name descname"><span class="pre">fill_from_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.fill_from_grid" title="Link to this definition"></a></dt>
<dd><p>Given a GridBatch and features associated with it, return a JaggedTensor representing features for this batch of grid.
Fill any voxels not in the GridBatch with the default value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_features</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> containing features associated with other_grid.</p></li>
<li><p><strong>other_grid</strong> (<a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><em>GridBatch</em></a>) – A GridBatch containing the grid to fill from.</p></li>
<li><p><strong>default_value</strong> (<em>float</em>) – The value to fill in for voxels not in the GridBatch (default 0.0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filled_features</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> of features associated with this batch of grids.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.grid_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid_count</span></span><a class="headerlink" href="#fvdb.GridBatch.grid_count" title="Link to this definition"></a></dt>
<dd><p>The number of grids indexed by this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.grid_to_world">
<span class="sig-name descname"><span class="pre">grid_to_world</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.grid_to_world" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.grid_to_world_matrices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid_to_world_matrices</span></span><a class="headerlink" href="#fvdb.GridBatch.grid_to_world_matrices" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 4, 4] tensor of the grid to world transformation matrices for each grid in this batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.ijk">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ijk</span></span><a class="headerlink" href="#fvdb.GridBatch.ijk" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, -1, 3] JaggedTensor of the ijk coordinates of each voxel in this batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.ijk_enabled">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ijk_enabled</span></span><a class="headerlink" href="#fvdb.GridBatch.ijk_enabled" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, -1, 3] JaggedTensor of the ijk coordinates of each enabled voxel in this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.ijk_to_index">
<span class="sig-name descname"><span class="pre">ijk_to_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.ijk_to_index" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.ijk_to_inv_index">
<span class="sig-name descname"><span class="pre">ijk_to_inv_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.ijk_to_inv_index" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.is_contiguous">
<span class="sig-name descname"><span class="pre">is_contiguous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fvdb.GridBatch.is_contiguous" title="Link to this definition"></a></dt>
<dd><p>Whether this grid batch is contiguous.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.is_same">
<span class="sig-name descname"><span class="pre">is_same</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fvdb.GridBatch.is_same" title="Link to this definition"></a></dt>
<dd><p>Check if this grid batch refers to the same underlying NanoVDB grid as another GridBatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><em>GridBatch</em></a>) – The other grid batch to compare to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>is_same</strong> (<em>bool</em>) – Whether the two grid batches are the same.”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.jagged_like">
<span class="sig-name descname"><span class="pre">jagged_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_disabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.jagged_like" title="Link to this definition"></a></dt>
<dd><p>Create a JaggedTensor with the same offsets as this grid batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – A tensor of shape <cite>[total_voxels, *]</cite> to be converted to a JaggedTensor.</p></li>
<li><p><strong>ignore_disabled</strong> (<em>bool</em>) – Whether to ignore disabled voxels when creating the JaggedTensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>jagged_data</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1, *]</cite> with the same offsets as this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.jidx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jidx</span></span><a class="headerlink" href="#fvdb.GridBatch.jidx" title="Link to this definition"></a></dt>
<dd><p>A [total_voxels,] tensor of the jagged index of each voxel in this batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.joffsets">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">joffsets</span></span><a class="headerlink" href="#fvdb.GridBatch.joffsets" title="Link to this definition"></a></dt>
<dd><p>A [num_grids+1,] tensor of the jagged offsets of each grid in this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.marching_cubes">
<span class="sig-name descname"><span class="pre">marching_cubes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.marching_cubes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fvdb.GridBatch.max_grids_per_batch">
<span class="sig-name descname"><span class="pre">max_grids_per_batch</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1024</span></em><a class="headerlink" href="#fvdb.GridBatch.max_grids_per_batch" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.max_pool">
<span class="sig-name descname"><span class="pre">max_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.max_pool" title="Link to this definition"></a></dt>
<dd><p>Downsample this batch of grids using maxpooling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool_factor</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – How much to pool by (i,e, <cite>(2,2,2)</cite> means take max over 2x2x2 from start of window).</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – Data at each voxel in this grid to be downsampled (JaggedTensor of shape <cite>[B, -1, *]</cite>).</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – The stride to use when pooling</p></li>
<li><p><strong>coarse_grid</strong> (<a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><em>GridBatch</em></a><em>, </em><em>optional</em>) – An optional coarse grid used to specify the output. This is mainly used
for memory efficiency so you can chache grids. If you don’t pass it in, we’ll just create it for you.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>coarse_data</strong> (<em>JaggedTensor</em>) – a JaggedTensor of shape <cite>[B, -1, *]</cite> of downsampled data.</p></li>
<li><p><strong>coarse_grid</strong> (<em>GridBatch</em>) – the downsampled grid batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.mutable">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mutable</span></span><a class="headerlink" href="#fvdb.GridBatch.mutable" title="Link to this definition"></a></dt>
<dd><p>Whether the grid is mutable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.neighbor_indexes">
<span class="sig-name descname"><span class="pre">neighbor_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bitshift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.neighbor_indexes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_bytes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_bytes</span></span><a class="headerlink" href="#fvdb.GridBatch.num_bytes" title="Link to this definition"></a></dt>
<dd><p>A [num_grids] tensor of the number of bytes used by each grid in this batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_enabled_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_enabled_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.num_enabled_voxels" title="Link to this definition"></a></dt>
<dd><p>An integer tensor containing the number of enabled voxels per grid indexed by this batch. If this grid is not mutable, this will be the same as num_voxels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_enabled_voxels_at">
<span class="sig-name descname"><span class="pre">num_enabled_voxels_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#fvdb.GridBatch.num_enabled_voxels_at" title="Link to this definition"></a></dt>
<dd><p>Get the number of enabled voxels in the bi^th grid in the batch. If this grid isn’t mutable, this returns the same value as num_voxels_at.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_leaf_nodes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_leaf_nodes</span></span><a class="headerlink" href="#fvdb.GridBatch.num_leaf_nodes" title="Link to this definition"></a></dt>
<dd><p>A [num_grids] tensor of the number of leaf nodes used by each grid in this batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.num_voxels" title="Link to this definition"></a></dt>
<dd><p>An integer tensor containing the number of voxels per grid indexed by this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.num_voxels_at">
<span class="sig-name descname"><span class="pre">num_voxels_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#fvdb.GridBatch.num_voxels_at" title="Link to this definition"></a></dt>
<dd><p>Get the number of voxels in the bi^th grid in the batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.origin_at">
<span class="sig-name descname"><span class="pre">origin_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#fvdb.GridBatch.origin_at" title="Link to this definition"></a></dt>
<dd><p>Get the origin of the bi^th grid in the batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.origins">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">origins</span></span><a class="headerlink" href="#fvdb.GridBatch.origins" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 3] tensor of world space origins for each grid in this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.points_in_active_voxel">
<span class="sig-name descname"><span class="pre">points_in_active_voxel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_disabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.points_in_active_voxel" title="Link to this definition"></a></dt>
<dd><p>Given a set of points, return a JaggedTensor of booleans indicating which points are in active voxels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of point positions.</p></li>
<li><p><strong>ignore_disabled</strong> (<em>bool</em>) – Whether to ignore disabled voxels when computing the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>points_in_active_voxel</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1]</cite> of booleans indicating which points are in active voxels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.ray_implicit_intersection">
<span class="sig-name descname"><span class="pre">ray_implicit_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_scalars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.ray_implicit_intersection" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.read_from_dense">
<span class="sig-name descname"><span class="pre">read_from_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.read_from_dense" title="Link to this definition"></a></dt>
<dd><p>Read the data in a dense tensor into a JaggedTensor indexed by this batch of grids. Non-indexed values are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dense_data</strong> (<em>torch.Tensor</em>) – A tensor of shape <cite>[num_grids, width, height, depth, *]</cite> of values to be read from.</p></li>
<li><p><strong>dense_origins</strong> (<em>list</em><em> of </em><em>floats</em>) – The ijk coordinate corresponding to <cite>dense_data[*, 0, 0, 0]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sparse_data</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[num_grids, -1, *]</cite> of values indexed by this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sample_bezier">
<span class="sig-name descname"><span class="pre">sample_bezier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.sample_bezier" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sample_bezier_with_grad">
<span class="sig-name descname"><span class="pre">sample_bezier_with_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.sample_bezier_with_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sample_trilinear">
<span class="sig-name descname"><span class="pre">sample_trilinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.sample_trilinear" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sample_trilinear_with_grad">
<span class="sig-name descname"><span class="pre">sample_trilinear_with_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.sample_trilinear_with_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.segments_along_rays">
<span class="sig-name descname"><span class="pre">segments_along_rays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_masked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.segments_along_rays" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_from_dense_grid">
<span class="sig-name descname"><span class="pre">set_from_dense_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_grids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatchOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_from_dense_grid" title="Link to this definition"></a></dt>
<dd><p>Set the voxels in this grid batch to a dense grid with shape [num_grids, width, height, depth], otpionally masking out certain voxels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_grids</strong> (<em>int</em>) – The number of grids in the batch</p></li>
<li><p><strong>dense_dims</strong> (<em>triple</em><em> of </em><em>ints</em>) – The dimensions of the dense grid <cite>[width, height, depth]</cite></p></li>
<li><p><strong>ijk_min</strong> (<em>triple</em><em> of </em><em>ints</em>) – Index space minimum bound of the dense grid.</p></li>
<li><p><strong>voxel_sizes</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the voxel size of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the voxel size for each grid.</p></li>
<li><p><strong>origins</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the world space origin of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the world space origin for each grid.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em>) – A tensor of shape [num_grids, width, height, depth] of booleans indicating which voxels to include/exclude.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_from_ijk">
<span class="sig-name descname"><span class="pre">set_from_ijk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatchOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_from_ijk" title="Link to this definition"></a></dt>
<dd><p>Set the voxels in this grid batch to those specified by a given set of ijk coordinates (with optional padding)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ijk</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of ijk coordinates.</p></li>
<li><p><strong>pad_min</strong> (<em>triple</em><em> of </em><em>ints</em>) – Index space minimum bound of the padding region.</p></li>
<li><p><strong>pad_max</strong> (<em>triple</em><em> of </em><em>ints</em>) – Index space maximum bound of the padding region.</p></li>
<li><p><strong>voxel_sizes</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the voxel size of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the voxel size for each grid.</p></li>
<li><p><strong>origins</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the world space origin of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the world space origin for each grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_from_mesh">
<span class="sig-name descname"><span class="pre">set_from_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_vertices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatchOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_from_mesh" title="Link to this definition"></a></dt>
<dd><p>Set the voxels in this grid batch to those which intersect a given triangle mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh_vertices</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of mesh vertex positions.</p></li>
<li><p><strong>mesh_faces</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of integer indexes into <cite>mesh_vertices</cite> specifying the faces of each mesh.</p></li>
<li><p><strong>voxel_sizes</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the voxel size of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the voxel size for each grid.</p></li>
<li><p><strong>origins</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the world space origin of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the world space origin for each grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_from_nearest_voxels_to_points">
<span class="sig-name descname"><span class="pre">set_from_nearest_voxels_to_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatchOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_from_nearest_voxels_to_points" title="Link to this definition"></a></dt>
<dd><p>Set the voxels in this grid batch to the nearest voxel to each point in a given point cloud</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of point positions.</p></li>
<li><p><strong>voxel_sizes</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the voxel size of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the voxel size for each grid.</p></li>
<li><p><strong>origins</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the world space origin of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the world space origin for each grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_from_points">
<span class="sig-name descname"><span class="pre">set_from_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatchOrScalar</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dBatch</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor([0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">dtype=torch.int32)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_from_points" title="Link to this definition"></a></dt>
<dd><p>Set the voxels in this grid batch to those which contain a point in a given point cloud (with optional padding)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of point positions.</p></li>
<li><p><strong>pad_min</strong> (<em>triple</em><em> of </em><em>ints</em>) – Index space minimum bound of the padding region.</p></li>
<li><p><strong>pad_max</strong> (<em>triple</em><em> of </em><em>ints</em>) – Index space maximum bound of the padding region.</p></li>
<li><p><strong>mesh_faces</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape [num_grids, -1, 3] of integer indexes into <cite>mesh_vertices</cite> specifying the faces of each mesh.</p></li>
<li><p><strong>voxel_sizes</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the voxel size of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the voxel size for each grid.</p></li>
<li><p><strong>origins</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tensor</em>) – Either a float or triple specifyng the world space origin of all the grids in the batch or a tensor of shape [num_grids, 3] specifying the world space origin for each grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_global_origin">
<span class="sig-name descname"><span class="pre">set_global_origin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3d</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_global_origin" title="Link to this definition"></a></dt>
<dd><p>Set the origin of all grids in this batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>origin</strong> (<em>list</em><em> of </em><em>floats</em>) – The new global origin of this batch of grids.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.set_global_voxel_size">
<span class="sig-name descname"><span class="pre">set_global_voxel_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3dOrScalar</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fvdb.GridBatch.set_global_voxel_size" title="Link to this definition"></a></dt>
<dd><p>Set the voxel size of all grids in this batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>voxel_size</strong> (<em>list</em><em> of </em><em>floats</em>) – The new global voxel size of this batch of grids.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sparse_conv_halo">
<span class="sig-name descname"><span class="pre">sparse_conv_halo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.sparse_conv_halo" title="Link to this definition"></a></dt>
<dd><p>Perform in-grid convolution using fast Halo Buffer method. Currently only supports 3x3x3 kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> containing features associated with this batch of grids.</p></li>
<li><p><strong>weight</strong> (<em>torch.Tensor</em>) – A tensor of shape <cite>[O, I, 3, 3, 3]</cite> containing the convolution kernel.</p></li>
<li><p><strong>variant</strong> (<em>int</em>) – Which variant of the Halo Buffer method to use. Currently 8 and 64 are supported.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> (<em>JaggedTensor</em>) – a JaggedTensor of shape <cite>[B, -1, *]</cite> of convolved data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.sparse_conv_kernel_map">
<span class="sig-name descname"><span class="pre">sparse_conv_kernel_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">fvdb.SparseConvPackInfo</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.sparse_conv_kernel_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.splat_bezier">
<span class="sig-name descname"><span class="pre">splat_bezier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.splat_bezier" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.splat_trilinear">
<span class="sig-name descname"><span class="pre">splat_trilinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.splat_trilinear" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdiv_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fine_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.subdivide" title="Link to this definition"></a></dt>
<dd><p>Subdivide the grid batch and associated data tensor into a finer GridBatch and data tensor using nearest neighbor sampling.
Each voxel [i, j, k] in this grid batch maps to voxels <cite>[i * subdivFactor, j * subdivFactor, k * subdivFactor]</cite> in the fine batch.
Each data value in the subdividided data tensor inherits its parent value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdiv_factor</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – How much to subdivide by (i,e, <cite>(2,2,2)</cite> means subdivide each voxel into 2^3 voxels).</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> containing data associated with this batch of grids.</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of booleans indicating which voxels to subdivide.</p></li>
<li><p><strong>fine_grid</strong> (<a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><em>GridBatch</em></a>) – An optional fine grid used to specify the output. This is mainly used
for memory efficiency so you can chache grids. If you don’t pass it in, we’ll just create it for you.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>fine_data</strong> (<em>JaggedTensor</em>) – A JaggedTensor of shape <cite>[B, -1, *]</cite> of data associated with the fine grid batch.</p></li>
<li><p><strong>fine_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the subdivided version of this grid batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.subdivided_grid">
<span class="sig-name descname"><span class="pre">subdivided_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdiv_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iOrScalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.subdivided_grid" title="Link to this definition"></a></dt>
<dd><p>Subdivide the grid batch into a finer grid batch.
Each voxel [i, j, k] in this grid batch maps to voxels <cite>[i * subdivFactor, j * subdivFactor, k * subdivFactor]</cite> in the fine batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdiv_factor</strong> (<em>int</em><em> or </em><em>3-tuple</em><em> of </em><em>ints</em>) – How much to subdivide by (i,e, <cite>(2,2,2)</cite> means subdivide each voxel into 2^3 voxels).</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, 3]</cite> of booleans indicating which voxels to subdivide.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>subdivided_grid</strong> (<em>GridBatch</em>) – A GridBatch representing the subdivided version of this grid batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fvdb.GridBatch.to" title="Link to this definition"></a></dt>
<dd><p>Overloaded function.</p>
<ol class="arabic simple">
<li><p>to(self: fvdb._Cpp.GridBatch, device: fvdb._Cpp.TorchDeviceOrString) -&gt; fvdb._Cpp.GridBatch</p></li>
<li><p>to(self: fvdb._Cpp.GridBatch, to_tensor: torch.Tensor) -&gt; fvdb._Cpp.GridBatch</p></li>
<li><p>to(self: fvdb._Cpp.GridBatch, to_jtensor: fvdb::JaggedTensor) -&gt; fvdb._Cpp.GridBatch</p></li>
<li><p>to(self: fvdb._Cpp.GridBatch, to_grid: fvdb._Cpp.GridBatch) -&gt; fvdb._Cpp.GridBatch</p></li>
</ol>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.total_bbox">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_bbox</span></span><a class="headerlink" href="#fvdb.GridBatch.total_bbox" title="Link to this definition"></a></dt>
<dd><p>A tensor, total_bbox, of shape [2, 3] where total_bbox = <cite>[[bmin_i, bmin_j, bmin_z=k],
[bmax_i, bmax_j, bmax_k]]</cite> is the bounding box such that <cite>bmin &lt;= ijk &lt; bmax</cite> for all voxels
ijk in the batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.total_bytes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_bytes</span></span><a class="headerlink" href="#fvdb.GridBatch.total_bytes" title="Link to this definition"></a></dt>
<dd><p>The total number of bytes used by this batch of grids.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.total_enabled_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_enabled_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.total_enabled_voxels" title="Link to this definition"></a></dt>
<dd><p>The total number of enabled voxels indexed by this batch of grids.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.total_leaf_nodes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_leaf_nodes</span></span><a class="headerlink" href="#fvdb.GridBatch.total_leaf_nodes" title="Link to this definition"></a></dt>
<dd><p>The total number of leaf nodes used by this batch of grids.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.total_voxels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_voxels</span></span><a class="headerlink" href="#fvdb.GridBatch.total_voxels" title="Link to this definition"></a></dt>
<dd><p>The total number of voxels indexed by this batch of grids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.uniform_ray_samples">
<span class="sig-name descname"><span class="pre">uniform_ray_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cone_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_end_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_midpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.uniform_ray_samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.viz_edge_network">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">viz_edge_network</span></span><a class="headerlink" href="#fvdb.GridBatch.viz_edge_network" title="Link to this definition"></a></dt>
<dd><p>A pair of JaggedTensors <cite>(gv, ge)</cite> of shape [num_grids, -1, 3] and [num_grids, -1, 2] where <cite>gv</cite> are the corner positions of each voxel and <cite>ge</cite> are edge indices indexing into <cite>gv</cite>. This property is useful for visualizing the grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.voxel_size_at">
<span class="sig-name descname"><span class="pre">voxel_size_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#fvdb.GridBatch.voxel_size_at" title="Link to this definition"></a></dt>
<dd><p>Get the voxel size of the bi^th grid in the batch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.voxel_sizes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">voxel_sizes</span></span><a class="headerlink" href="#fvdb.GridBatch.voxel_sizes" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 3] tensor of voxel sizes for each grid in this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.voxels_along_rays">
<span class="sig-name descname"><span class="pre">voxels_along_rays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_origins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_voxels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fvdb.GridBatch.voxels_along_rays" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.world_to_grid">
<span class="sig-name descname"><span class="pre">world_to_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></span><a class="headerlink" href="#fvdb.GridBatch.world_to_grid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fvdb.GridBatch.world_to_grid_matrices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">world_to_grid_matrices</span></span><a class="headerlink" href="#fvdb.GridBatch.world_to_grid_matrices" title="Link to this definition"></a></dt>
<dd><p>A [num_grids, 4, 4] tensor of the world to grid transformation matrices for each grid in this batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fvdb.GridBatch.write_to_dense">
<span class="sig-name descname"><span class="pre">write_to_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fvdb.GridBatch" title="fvdb.GridBatch"><span class="pre">fvdb.GridBatch</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><span class="pre">fvdb.JaggedTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3iBatch</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fvdb.Vec3i</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#fvdb.GridBatch.write_to_dense" title="Link to this definition"></a></dt>
<dd><p>Read the data in a tensor indexed by this batch of grids into a dense tensor, setting non indexed values to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sparse_data</strong> (<a class="reference internal" href="jagged_tensor.html#fvdb.JaggedTensor" title="fvdb.JaggedTensor"><em>JaggedTensor</em></a>) – A JaggedTensor of shape <cite>[num_grids, -1, *]</cite> of values indexed by this grid batch.</p></li>
<li><p><strong>min_coord</strong> (<em>list</em><em> of </em><em>ints</em>) – Index space minimum bound of the dense grid.</p></li>
<li><p><strong>grid_size</strong> (<em>list</em><em> of </em><em>ints</em>) – The dimensions of the dense grid to read into <cite>[width, height, depth]</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dense_data</strong> (<em>torch.Tensor</em>) – A tensor of shape <cite>[num_grids, width, height, depth, *]</cite> of values indexed by this grid batch.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials/volume_rendering.html" class="btn btn-neutral float-left" title="Volume Rendering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="jagged_tensor.html" class="btn btn-neutral float-right" title="JaggedTensor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Contributors to the OpenVDB Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>